import{d as Ke,z as re,r as v,c as d,O as m,aJ as se,N as ie,y as le,q as ne,a0 as Qe,b9 as Xe,a as f,o,a7 as N,b as l,i as n,m as c,aS as W,e as i,S as b,n as _,u as e,t as h,k as p,A as Ye,Z as ue,R as et,s as tt,B as at}from"./vue-5LosNL5q.js";import{b as x,w as ot}from"./global-CW_UE6pr.js";import{u as Pe,A as de,_ as me}from"./AuthLoginThirdPartyGroupButtons.vue_vue_type_script_setup_true_lang-D7gGsdzQ.js";import{d as rt}from"./current_dir-Jbh72wVc.js";import{i as ce}from"./email-DXqh3X1m.js";import{t as a}from"./intl-BugLfTm4.js";import{_ as pe}from"./OzBackButton.vue_vue_type_script_setup_true_lang-DbDqzYV8.js";import{_ as st}from"./OzCheckBox.vue_vue_type_script_setup_true_lang-Bb_dyvpv.js";import{O as fe,_ as he}from"./OzContainedButton.vue_vue_type_script_setup_true_lang-ClYtfwNp.js";import{O as ge}from"./OzIcon-C1BaNzaK.js";import{O as ve}from"./OzInput-CYToxeLl.js";import{_ as be}from"./OzLabelInput.vue_vue_type_script_setup_true_lang-y0Mn5Cd6.js";import{O as it}from"./OzLoadingText-CGfJLlZB.js";import{O as _e}from"./OzPadletLogo-J3Zv8nQa.js";import{a as ye,O as we,_ as xe}from"./OzPlainButton.vue_vue_type_script_setup_true_lang-6hx_dE3n.js";import{_ as D}from"./OzTextLink.vue_vue_type_script_setup_true_lang-hY_ZpBVv.js";import{u as lt}from"./window_size-DTF_jeIz.js";import{_ as nt}from"./AuthActionMenu.vue_vue_type_script_setup_true_lang-B3nvpNci.js";import{_ as ut}from"./AuthBottomNav.vue_vue_type_script_setup_true_lang-CpsGWydk.js";import{_ as ke}from"./AuthLoginSAMLButton.vue_vue_type_script_setup_true_lang-Dqu3tiN-.js";import{G as dt}from"./GlobalSnackbar-Dqf4MTTo.js";import{_ as mt}from"./SkipToContentLink.vue_vue_type_script_setup_true_lang-DbCrBgRX.js";import"./_sentry-release-injection-file-C6Dk74V5.js";/* empty css                 */import"./es-toolkit-BjwwpW6e.js";import"./electron_bridge-C4ZQpE0S.js";import"./OzDropdownButton.vue_vue_type_script_setup_true_lang-BJXFFgeH.js";import"./OzBaseButton.vue_vue_type_script_setup_true_lang-Dqo5CQIQ.js";import"./enums-BQ-vjTUP.js";import"./accessibility_settings_store-BDJm1wAz.js";import"./analytics-DRzhb9BV.js";import"./json_stringify-DJN8akZC.js";import"./user_model-DYtUt2lw.js";import"./current_user-R1QAovu2.js";import"./api_url_interpolate-CBYJqV7y.js";import"./api_fetch-BryPKiWn.js";import"./fetch-CGnu6HEI.js";import"./index-DzOKOCut.js";import"./dark_mode-CloUfF-f.js";import"./AuthLoginThirdPartyButton.vue_vue_type_script_setup_true_lang-CB7Rat3e.js";import"./OzBadge.vue_vue_type_script_setup_true_lang-ByRqlNW8.js";import"./OzIconButton.vue_vue_type_script_setup_true_lang-Bddir12g.js";import"./_plugin-vue_export-helper-DCyA4Sjg.js";import"./locale-BRfIpvy6.js";import"./OzMenuRows.vue_vue_type_script_setup_true_lang-CcpAECTJ.js";import"./OzDivider.vue_vue_type_script_setup_true_lang-WAMtEbno.js";import"./vivaldi_client-By7Wq6mp.js";import"./pixel_ratio-H8pIgHff.js";import"./OzPopoverModal.vue_vue_type_script_setup_true_lang-CLDw1m3N.js";import"./resize_observer-DZaKq0um.js";import"./OzBox.vue_vue_type_script_setup_true_lang-DipA1Zev.js";import"./OzOverlay-F6LNOUiv.js";import"./post_message-C160tQJW.js";import"./OzScreenSizeAwarePopoverModal.vue_vue_type_script_setup_true_lang-Cl8xxml-.js";import"./OzDrawerDraggable-CGnd2ulf.js";import"./OzDrawerStatic-D6j13kda.js";import"./LocaleMenu.vue_vue_type_script_setup_true_lang-BIL1V2jl.js";import"./LocaleSelector.vue_vue_type_script_setup_true_lang-BTOfY9_4.js";import"./lodash-es-CgBqvrBB.js";(function(){try{var y=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},S=new y.Error().stack;S&&(y._sentryDebugIds=y._sentryDebugIds||{},y._sentryDebugIds[S]="7e36f5f5-a977-4f11-8627-2bae2b526db3",y._sentryDebugIdIdentifier="sentry-dbid-7e36f5f5-a977-4f11-8627-2bae2b526db3")}catch{}})();const ct={class:"relative flex flex-col items-center min-h-full"},pt={class:"flex items-center text-body-small"},ft={class:"text-dark-text-200 dark:text-light-text-200"},ht={id:"main-content",class:_(["h-full","grow tablet-portrait:grow-0","flex","flex-col","justify-end tablet-portrait:justify-center","box-border","w-full","p-4","tablet-portrait:relative tablet-portrait:w-[375px] tablet-portrait:p-0 tablet-portrait:px-4 tablet-portrait:mt-18"]),tabindex:"-1"},gt={class:"text-dark-text-100 dark:text-light-text-100 mb-5"},vt={class:"w-80 text-login-heading-1 font-semibold px-2 mb-1"},bt={class:"text-login-body px-2"},_t={for:"username-input",class:_(["text-body-small-posts","text-dark-text-100 dark:text-light-text-100","px-2"])},yt={for:"password-input",class:_(["text-body-small-posts","text-dark-text-100 dark:text-light-text-100","px-2"])},wt={class:"flex justify-center tablet-portrait:justify-end"},xt={class:"text-body-small-posts text-dark-text-200 dark:text-light-text-200 text-center tablet-portrait:text-start px-2 tablet-portrait:mb-4"},kt=Ke({__name:"AuthLoginApp",setup(y){const S=lt(),R=Pe(),{isSmallerThanTabletPortrait:k}=re(S),{username:w,password:L,usernameValidationMessage:B,passwordValidationMessage:U,isAwaitingServerResponse:g,thirdPartyAuthLoginMethods:j,userThirdPartyAuthLoginMethods:$,samlLoginMethods:E,oidcLoginMethods:H,isUsernameVerified:q,isUsernameValid:Ie,isPasswordValid:Se,codeChallenge:G,codeChallengeMethod:J,pkceState:Z,originAppClientId:K,originAppRedirectUri:Q,isPkceEnabled:X,isPasswordLoginEnabled:C,isSchoolLibraryLoginPage:Le,isTeamLibraryLoginPage:Be,libraryName:Y}=re(R),{setUsername:Ue,setUsernameValidationMessage:Ce,setPassword:ee,setPasswordValidationMessage:te,setIsUsernameVerified:Oe,continueWithEmailOrUsername:ze,loginWithPassword:Ve,resetIsAwaitingServerResponse:Ae}=R,O=v(),z=v(),V=v(!1),T=v(!1),F=v(!1),P=v(!1),I=v(""),De=d(()=>!(m.mobile&&m.android&&k.value&&(T.value||F.value))),Re=d(()=>!w.value.length||!!B.value.length),$e=d(()=>!L.value.length||!!U.value.length),ae=d(()=>{const r=se("/auth/signup");return X.value?ie(r,{searchParams:{code_challenge:G.value,code_challenge_method:J.value,redirect_uri:encodeURIComponent(Q.value),client_id:K.value,pkce_state:Z.value}}):r}),Ee=d(()=>{const r=se("/auth/org_login_redirect");return X.value?ie(r,{searchParams:{code_challenge:G.value,code_challenge_method:J.value,redirect_uri:encodeURIComponent(Q.value),client_id:K.value,pkce_state:Z.value}}):r}),Te=d(()=>ce(w.value)?a("Log in with email"):a("Log in with username")),Fe=d(()=>ce(w.value)?le({},{path:"/auth/forgot",search:{email:w.value}}):le({},{path:"/auth/forgot"})),s=d(()=>!q.value),Me=d(()=>{var t;return((t=new URLSearchParams(x.location.search).get("referrer"))==null?void 0:t.includes("school-library/create"))||!1});ne(s,r=>{setTimeout(()=>{et(()=>{var t,u;r?(t=O.value)==null||t.focusInput():(u=z.value)==null||u.focusInput()})},1)},{immediate:!0}),ne(g,r=>{const t=document.getElementsByTagName("html")[0];s.value||(r?t.classList.add("dot-grid-loading"):t.classList.remove("dot-grid-loading"))}),Qe(()=>{x.removeEventListener("popstate",A)});function Ne(r){s.value&&(Ue(r.target.value),B.value.length&&Ce(""))}function We(r){ee(I.value||r.target.value),I.value&&(I.value=""),U.value.length&&te("")}function je(){T.value=!0}function He(){F.value=!0}function qe(){T.value=!1}function Ge(){F.value=!1}function A(r){if(r.type==="click"){Xe();return}if(document.referrer!==""){const t=["/dashboard/settings/library_delete","/dashboard/settings/delete"],u=new URL(document.referrer);if(t.includes(u.pathname))return}P.value=!1,I.value="",Oe(!1),ee(""),te(""),Ae()}async function Je(){var r,t,u,M,oe;s.value?((r=O.value)==null||r.blurInput(),await ze(),B.value.length&&((t=O.value)==null||t.focusInput()),L.value&&(I.value=L.value),q.value&&!((u=x.history.state)!=null&&u.didPushState)&&x.history.pushState({didPushState:!0},"",x.location.href),x.addEventListener("popstate",A)):((M=z.value)==null||M.blurInput(),await Ve(),U.value.length&&((oe=z.value)==null||oe.focusInput()))}const Ze=d(()=>s.value?Y.value!==null?a("Log in to %{libraryName}",{libraryName:Y.value}):a("Log in"):Te.value);return(r,t)=>(o(),f("div",ct,[N(l("header",{class:_(["flex items-center justify-between box-border w-full px-4 transition-all",s.value||e(m).desktop&&!e(k)?"h-14 ps-5":"h-18 tablet-portrait:ps-6"])},[i(mt),s.value?(o(),f(b,{key:0},[i(_e,{class:_([{invisible:e(m).electronApp}])},null,8,["class"]),l("div",pt,[e(m).desktop&&!e(k)?(o(),f(b,{key:0},[l("span",ft,h(e(a)("Not a member?")),1),i(D,{href:ae.value,text:e(a)("Sign up"),class:"font-semibold ms-1 me-2"},null,8,["href","text"])],64)):(o(),f(b,{key:1},[i(D,{href:ae.value,text:e(a)("Sign up"),class:"font-semibold me-2"},null,8,["href","text"]),i(xe,{"color-scheme":e(we).SecondaryIcon,"size-preset":e(ye).H28px,"aria-label":e(a)("Open more menu dialog"),"data-testid":"actionMenuButton",onClick:t[0]||(t[0]=u=>V.value=!0)},{default:p(()=>[i(ge,{size:20,name:"more_vertical"})]),_:1},8,["color-scheme","size-preset","aria-label"])],64))])],64)):(o(),f(b,{key:1},[e(m).desktop&&!e(k)?(o(),n(_e,{key:0,class:_([{invisible:e(m).electronApp}])},null,8,["class"])):(o(),f(b,{key:1},[i(pe,{"data-testid":"landsideLoginBackButton",disabled:e(g),onClick:A},null,8,["disabled"]),e(m).tablet?(o(),n(xe,{key:0,"color-scheme":e(we).SecondaryIcon,"size-preset":e(ye).H28px,"aria-label":e(a)("Open more menu dialog"),onClick:t[1]||(t[1]=u=>V.value=!0)},{default:p(()=>[i(ge,{size:20,name:"more_vertical"})]),_:1},8,["color-scheme","size-preset","aria-label"])):c("",!0)],64))],64))],2),[[W,De.value]]),l("main",ht,[!s.value&&e(m).desktop&&!e(k)?(o(),n(pe,{key:0,"data-testid":"landsideLoginBackButton",disabled:e(g),class:"mb-5",onClick:A},null,8,["disabled"])):c("",!0),l("div",gt,[l("h1",vt,h(Ze.value),1),l("h2",bt,h(s.value?e(a)("Welcome back to where you belong"):e(w)),1)]),e(E)!==null&&e(E).length>0?(o(),n(ke,{key:1,methods:e(E),"should-cache-preferred-login-method":!0,class:"mb-2"},null,8,["methods"])):c("",!0),e(H).length>0?(o(),n(ke,{key:2,methods:e(H),"should-cache-preferred-login-method":!0,class:"mb-2"},null,8,["methods"])):c("",!0),s.value&&Object.keys(e(j)).length?(o(),n(me,{key:3,"login-methods":e(j),type:e(de).LogIn,"should-cache-preferred-login-method":!0,class:"mb-5"},null,8,["login-methods","type"])):!s.value&&Object.keys(e($)).length?(o(),n(me,{key:4,"show-more-dropdown":!1,"login-methods":e($),type:e(de).Continue,"should-cache-preferred-login-method":!0,class:"mb-5"},null,8,["login-methods","type"])):c("",!0),l("form",{novalidate:"",class:_(["flex flex-col mb-6",{"tablet-portrait:mb-[72px]":s.value}]),onSubmit:Ye(Je,["prevent"])},[N(i(be,{class:"mb-4"},{label:p(()=>[l("label",_t,h(e(a)("Or, log in with email/username")),1)]),input:p(()=>[i(ve,{id:"username-input",ref_key:"usernameInputRef",ref:O,name:"username",autocomplete:"email",type:"email","test-id":"usernameInput",disabled:e(g),"model-value":e(w),"validation-message":e(B),placeholder:"harrypotter@hogwarts.edu",valid:e(Ie),required:!0,class:"bg-light-ui-100 dark:bg-dark-ui-100",onInput:Ne,onFocusin:je,onBlur:qe},null,8,["disabled","model-value","validation-message","valid"])]),_:1},512),[[W,s.value&&e(C)]]),N(i(be,{class:"mb-4"},{label:p(()=>[l("label",yt,h(Object.keys(e($)).length?e(a)("Or enter password"):e(a)("Enter password")),1)]),inputAccessory:p(()=>[i(st,{value:P.value,label:e(a)("Show"),"aria-label":e(a)("Show password as plain text. Warning: this will display your password on the screen."),dir:e(rt)(),class:"px-2",onInput:t[2]||(t[2]=u=>P.value=!P.value)},null,8,["value","label","aria-label","dir"])]),input:p(()=>[i(ve,{id:"password-input",ref_key:"passwordInputRef",ref:z,name:"password",autocomplete:"current-password",autocapitalize:"none",type:P.value?"text":"password","test-id":"passwordInput",disabled:e(g),"model-value":e(L),"validation-message":e(U),placeholder:e(a)("Enter password"),valid:e(Se),required:!0,class:"bg-light-ui-100 dark:bg-dark-ui-100",onInput:We,onFocusin:He,onBlur:Ge},null,8,["type","disabled","model-value","validation-message","placeholder","valid"])]),_:1},512),[[W,!s.value&&e(C)]]),l("div",wt,[s.value?(o(),n(he,{key:0,"data-testid":"continueButton","data-pw":"continueButton","color-scheme":e(fe).Primary,disabled:e(g)||Re.value,class:"w-full tablet-portrait:w-auto"},{default:p(()=>[ue(h(e(a)("Continue")),1)]),_:1},8,["color-scheme","disabled"])):e(C)?(o(),f(b,{key:1},[e(g)?(o(),n(it,{key:0,text:e(a)("Logging in..."),class:"text-heading-4 text-center font-semibold px-5 py-2"},null,8,["text"])):(o(),n(he,{key:1,"data-testid":"loginButton","data-pw":"loginButton","color-scheme":e(fe).Primary,disabled:$e.value,class:"w-full tablet-portrait:w-auto"},{default:p(()=>[ue(h(e(a)("Log in")),1)]),_:1},8,["color-scheme","disabled"]))],64)):c("",!0)])],34),l("p",xt,[s.value&&!Me.value&&!e(Le)&&!e(Be)?(o(),f(b,{key:0},[l("span",null,h(e(a)("Backpack or Briefcase user?")),1),i(D,{href:Ee.value,text:e(a)("Log in here"),class:"font-semibold ms-1"},null,8,["href","text"])],64)):e(C)?(o(),n(D,{key:1,href:Fe.value,text:e(a)("Forgot password?"),class:"font-semibold","data-testid":"forgotPasswordLink"},null,8,["href","text"])):c("",!0)]),V.value?(o(),n(nt,{key:5,onCancel:t[3]||(t[3]=u=>V.value=!1)})):c("",!0),i(dt)]),e(m).desktop?(o(),n(ut,{key:0,class:"fixed start-6 bottom-6 hidden tablet-portrait:flex"})):c("",!0)]))}});tt({el:"#auth_login_app",rootComponent:kt,usePinia:!0,initializePiniaStore(){Pe().initialize(ot.vueStartingState)}}).catch(at);
//# sourceMappingURL=auth_login_app-Dc1TVYGk.js.map
